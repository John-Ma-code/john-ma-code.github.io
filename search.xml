<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>还在用Tableau画雷达图吗？用Pyecharts库，只需几行代码瞬间搞定雷达图</title>
    <url>/2021/03/07/pyecharts%E9%9B%B7%E8%BE%BE%E5%9B%BE/</url>
    <content><![CDATA[<h1 id="还在用Tableau画雷达图吗？用Pyecharts库，只需几行代码瞬间搞定雷达图"><a href="#还在用Tableau画雷达图吗？用Pyecharts库，只需几行代码瞬间搞定雷达图" class="headerlink" title="还在用Tableau画雷达图吗？用Pyecharts库，只需几行代码瞬间搞定雷达图"></a>还在用Tableau画雷达图吗？用Pyecharts库，只需几行代码瞬间搞定雷达图</h1><h3 id="首先，来介绍一下Pyecharts"><a href="#首先，来介绍一下Pyecharts" class="headerlink" title="首先，来介绍一下Pyecharts."></a>首先，来介绍一下Pyecharts.</h3><p>Pyecharts是我国开发人员开发的，相比较Matplotlib、Seaborn等可视化，Pyehcarts十分符合国内用户的习惯。<br>Pyecharts的目的是实现Echarts与Python的对接，以便在Python中使用Echarts生成图表。<br>Echarts是Apache软件基金会的一个数据可视化JavaScript库，生成图的可视化效果非常好，其凭借良好的交互性，精巧的图表设计，得到众多开发者的认可。</p>
<span id="more"></span>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">ld_pict = pd.read_excel(<span class="string">&quot;雷达图数据.xlsx&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line">ld_pict.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>进攻能力</th>
      <th>进攻能力.1</th>
      <th>辅助能力</th>
      <th>拆塔能力</th>
      <th>打钱能力</th>
      <th>单挑能力</th>
      <th>团战能力</th>
      <th>升级速度</th>
      <th>存活能力</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>玩家A</th>
      <td>3.60</td>
      <td>3.60</td>
      <td>3.11</td>
      <td>4.49</td>
      <td>3.72</td>
      <td>2.54</td>
      <td>4.35</td>
      <td>4.28</td>
      <td>1.75</td>
    </tr>
    <tr>
      <th>玩家B</th>
      <td>4.43</td>
      <td>4.43</td>
      <td>2.95</td>
      <td>4.48</td>
      <td>4.33</td>
      <td>2.65</td>
      <td>4.43</td>
      <td>4.28</td>
      <td>2.05</td>
    </tr>
    <tr>
      <th>玩家C</th>
      <td>4.31</td>
      <td>4.31</td>
      <td>2.44</td>
      <td>3.75</td>
      <td>4.63</td>
      <td>1.75</td>
      <td>2.50</td>
      <td>3.50</td>
      <td>3.13</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 由于进攻能力多出一列，故将该列删除</span></span><br><span class="line">ld_pict.drop(<span class="string">&quot;进攻能力.1&quot;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ld_pict</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>进攻能力</th>
      <th>辅助能力</th>
      <th>拆塔能力</th>
      <th>打钱能力</th>
      <th>单挑能力</th>
      <th>团战能力</th>
      <th>升级速度</th>
      <th>存活能力</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>玩家A</th>
      <td>3.60</td>
      <td>3.11</td>
      <td>4.49</td>
      <td>3.72</td>
      <td>2.54</td>
      <td>4.35</td>
      <td>4.28</td>
      <td>1.75</td>
    </tr>
    <tr>
      <th>玩家B</th>
      <td>4.43</td>
      <td>2.95</td>
      <td>4.48</td>
      <td>4.33</td>
      <td>2.65</td>
      <td>4.43</td>
      <td>4.28</td>
      <td>2.05</td>
    </tr>
    <tr>
      <th>玩家C</th>
      <td>4.31</td>
      <td>2.44</td>
      <td>3.75</td>
      <td>4.63</td>
      <td>1.75</td>
      <td>2.50</td>
      <td>3.50</td>
      <td>3.13</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> options <span class="keyword">as</span> opts <span class="comment">#用以设置</span></span><br><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> Radar <span class="comment">#导入雷达类</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 这里需要告诉pyecharts编辑器为jupyter lab</span></span><br><span class="line"><span class="keyword">from</span> pyecharts.<span class="built_in">globals</span> <span class="keyword">import</span> CurrentConfig, NotebookType,_WarningControl </span><br><span class="line">CurrentConfig.NOTEBOOK_TYPE = NotebookType.JUPYTER_LAB</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 这里为了忽略pyecharts1.9.0之后的版本中出现的警告</span></span><br><span class="line">_WarningControl.ShowWarning = <span class="literal">False</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">value_list = [[ld_pict.iloc[i,:].values.tolist()] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ld_pict.index))]</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">radar1=(</span><br><span class="line">    Radar()</span><br><span class="line">    .add_schema(<span class="comment"># 添加schema架构</span></span><br><span class="line">        schema=[</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">0</span>],max_=<span class="number">5</span>),<span class="comment"># 设置指示器名称和最大值</span></span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">1</span>],max_=<span class="number">5</span>),</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">2</span>],max_=<span class="number">5</span>),</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">3</span>],max_=<span class="number">5</span>),</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">4</span>],max_=<span class="number">5</span>),</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">5</span>],max_=<span class="number">5</span>),</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">6</span>],max_=<span class="number">5</span>),</span><br><span class="line">            opts.RadarIndicatorItem(name=ld_pict.columns[<span class="number">7</span>],max_=<span class="number">5</span>),</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">    .add(ld_pict.index[<span class="number">0</span>],value_list[<span class="number">0</span>],color=<span class="string">&quot;#f9713c&quot;</span>) <span class="comment"># 添加一条数据，参数1为数据名，参数2为数据，参数3为颜色</span></span><br><span class="line">    .add(ld_pict.index[<span class="number">1</span>],value_list[<span class="number">1</span>],color=<span class="string">&quot;#4169E1&quot;</span>) </span><br><span class="line">    .add(ld_pict.index[<span class="number">2</span>],value_list[<span class="number">2</span>],color=<span class="string">&quot;#00BFFF&quot;</span>) </span><br><span class="line">    .set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;雷达图&#x27;</span>),)</span><br><span class="line">)</span><br><span class="line"><span class="comment"># 这里必须先加载js才能正常显示图形</span></span><br><span class="line">radar1.load_javascript()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">radar1.render_notebook()</span><br></pre></td></tr></table></figure>



<p><img src="/images/%E9%9B%B7%E8%BE%BE%E5%9B%BE.png" alt="雷达图"></p>
<p><strong>看起来代码比较长，大部分还是在数据的处理上，真正画图的就是几步而已，你学会了吗？</strong></p>
]]></content>
      <categories>
        <category>数据可视化</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Pyrcharts</tag>
      </tags>
  </entry>
  <entry>
    <title>pyecharts 饼图 玫瑰图</title>
    <url>/2021/03/10/pyecharts%E9%A5%BC%E5%9B%BE%20%E7%8E%AB%E7%91%B0%E5%9B%BE/</url>
    <content><![CDATA[<h1 id="文章目录"><a href="#文章目录" class="headerlink" title="文章目录"></a>文章目录</h1><span id="more"></span>
<h2 id="一、-饼图"><a href="#一、-饼图" class="headerlink" title="一、 饼图"></a>一、 饼图</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> Pie</span><br><span class="line"><span class="keyword">import</span> pyecharts.options <span class="keyword">as</span> opts</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts.<span class="built_in">globals</span> <span class="keyword">import</span> CurrentConfig, NotebookType  </span><br><span class="line">CurrentConfig.NOTEBOOK_TYPE = NotebookType.JUPYTER_LAB</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_data = [<span class="string">&quot;深度学习&quot;</span>, <span class="string">&quot;数据分析&quot;</span>, <span class="string">&quot;Web开发&quot;</span>, <span class="string">&quot;爬虫&quot;</span>, <span class="string">&quot;图像处理&quot;</span>]</span><br><span class="line">y_data = [<span class="number">688</span>, <span class="number">888</span>, <span class="number">560</span>, <span class="number">388</span>, <span class="number">480</span>]</span><br><span class="line">data_pair = [<span class="built_in">list</span>(z) <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">zip</span>(x_data, y_data)]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data_pair</span><br></pre></td></tr></table></figure>




<pre><code>[[&#39;深度学习&#39;, 688], [&#39;数据分析&#39;, 888], [&#39;Web开发&#39;, 560], [&#39;爬虫&#39;, 388], [&#39;图像处理&#39;, 480]]
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data_pair.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data_pair</span><br></pre></td></tr></table></figure>




<pre><code>[[&#39;爬虫&#39;, 388], [&#39;图像处理&#39;, 480], [&#39;Web开发&#39;, 560], [&#39;深度学习&#39;, 688], [&#39;数据分析&#39;, 888]]
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pie = (</span><br><span class="line">    Pie(init_opts=opts.InitOpts(width=<span class="string">&quot;1200px&quot;</span>, height=<span class="string">&quot;800px&quot;</span>, bg_color=<span class="string">&quot;#2c343c&quot;</span>))</span><br><span class="line">    .add(</span><br><span class="line">        series_name=<span class="string">&quot;学习方向&quot;</span>, <span class="comment"># 系列名称</span></span><br><span class="line">        data_pair=data_pair, <span class="comment"># 数据格式为[(key1,value1),(key2,value2)]</span></span><br><span class="line">        rosetype=<span class="string">&quot;radius&quot;</span>, <span class="comment"># radius：扇区圆心角展现数据的百分比，半径展现数据的大小</span></span><br><span class="line">        radius=<span class="string">&quot;55%&quot;</span>,             <span class="comment"># 饼图的半径</span></span><br><span class="line">        center=[<span class="string">&quot;50%&quot;</span>, <span class="string">&quot;50%&quot;</span>],    <span class="comment"># 饼图的中心（圆心）坐标，数组的第一项是横坐标，第二项是纵坐标</span></span><br><span class="line">        </span><br><span class="line">    )</span><br><span class="line">    .set_global_opts(</span><br><span class="line">        title_opts=opts.TitleOpts(</span><br><span class="line">            title=<span class="string">&quot;Customized Pie&quot;</span>,</span><br><span class="line">            pos_left=<span class="string">&quot;center&quot;</span>,</span><br><span class="line">            pos_top=<span class="string">&quot;20&quot;</span>,</span><br><span class="line">            title_textstyle_opts=opts.TextStyleOpts(color=<span class="string">&quot;#fff&quot;</span>),</span><br><span class="line">        ),</span><br><span class="line">        legend_opts=opts.LegendOpts(is_show=<span class="literal">False</span>),</span><br><span class="line">    )</span><br><span class="line">    .set_series_opts(</span><br><span class="line">        tooltip_opts=opts.TooltipOpts(</span><br><span class="line">            trigger=<span class="string">&quot;item&quot;</span>, formatter=<span class="string">&quot;&#123;a&#125; &lt;br/&gt;&#123;b&#125;: &#123;c&#125; (&#123;d&#125;%)&quot;</span>  <span class="comment"># &#x27;item&#x27;: 数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用</span></span><br><span class="line">         ),</span><br><span class="line">        label_opts=opts.LabelOpts(color=<span class="string">&quot;rgba(255, 255, 255, 0.3)&quot;</span>),</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line">pie.load_javascript()</span><br></pre></td></tr></table></figure>






<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pie.render_notebook()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/10/pyecharts%E9%A5%BC%E5%9B%BE%20%E7%8E%AB%E7%91%B0%E5%9B%BE/%E9%A5%BC%E5%9B%BE.png" alt="图像"></p>
<h2 id="二、-环形图"><a href="#二、-环形图" class="headerlink" title="二、 环形图"></a>二、 环形图</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts.faker <span class="keyword">import</span> Faker</span><br><span class="line">c = (</span><br><span class="line">    Pie()</span><br><span class="line">    .add(</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        [<span class="built_in">list</span>(z) <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">zip</span>(Faker.choose(), Faker.values())],</span><br><span class="line">        <span class="comment"># 饼图的半径，数组的第一项是内半径，第二项是外半径</span></span><br><span class="line">        <span class="comment"># 默认设置成百分比，相对于容器高宽中较小的一项的一半</span></span><br><span class="line">        radius=[<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;60%&quot;</span>],</span><br><span class="line">    )</span><br><span class="line">    .set_colors([<span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;	#800000&quot;</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;#000000&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;purple&quot;</span>])</span><br><span class="line">    .set_global_opts(</span><br><span class="line">        title_opts=opts.TitleOpts(title=<span class="string">&quot;Pie-Radius&quot;</span>),</span><br><span class="line">        legend_opts=opts.LegendOpts(orient=<span class="string">&quot;vertical&quot;</span>, pos_top=<span class="string">&quot;15%&quot;</span>, pos_left=<span class="string">&quot;2%&quot;</span>),</span><br><span class="line">    )</span><br><span class="line">    .set_series_opts(label_opts=opts.LabelOpts(formatter=<span class="string">&quot;&#123;b&#125;: &#123;c&#125; &quot;</span>))</span><br><span class="line">)</span><br><span class="line">c.load_javascript()</span><br></pre></td></tr></table></figure>






<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.render_notebook()</span><br></pre></td></tr></table></figure>



<p><img src="/2021/03/10/pyecharts%E9%A5%BC%E5%9B%BE%20%E7%8E%AB%E7%91%B0%E5%9B%BE/%E7%8E%AF%E5%BD%A2%E5%9B%BE.png" alt="图像"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">labels = [<span class="string">&#x27;可乐&#x27;</span>, <span class="string">&#x27;雪碧&#x27;</span>, <span class="string">&#x27;橙汁&#x27;</span>, <span class="string">&#x27;奶茶&#x27;</span>, <span class="string">&#x27;冰啤酒&#x27;</span>, <span class="string">&#x27;柠檬水&#x27;</span>]</span><br><span class="line">values = [<span class="number">6</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">52</span>, <span class="number">72</span>, <span class="number">96</span>]</span><br><span class="line">v = Faker.choose()</span><br><span class="line">c = (</span><br><span class="line">    Pie()</span><br><span class="line">    .add(</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        [<span class="built_in">list</span>(z) <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">zip</span>(Faker.choose(), Faker.values())],</span><br><span class="line">        radius=[<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;75%&quot;</span>],</span><br><span class="line">        center=[<span class="string">&quot;22%&quot;</span>, <span class="string">&quot;50%&quot;</span>],</span><br><span class="line">        rosetype=<span class="string">&quot;radius&quot;</span>,</span><br><span class="line">        label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>),</span><br><span class="line">    )</span><br><span class="line">    .add(</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        [<span class="built_in">list</span>(z) <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">zip</span>(Faker.choose(), Faker.values())],</span><br><span class="line">        radius=[<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;75%&quot;</span>],</span><br><span class="line">        center=[<span class="string">&quot;70%&quot;</span>, <span class="string">&quot;50%&quot;</span>],</span><br><span class="line">        rosetype=<span class="string">&quot;area&quot;</span>,</span><br><span class="line">    )</span><br><span class="line">    .set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&quot;Pie-玫瑰图示例&quot;</span>),</span><br><span class="line">                     legend_opts=opts.LegendOpts(is_show=<span class="literal">False</span>)</span><br><span class="line">                     )</span><br><span class="line">    </span><br><span class="line">)</span><br><span class="line">c.load_javascript()</span><br></pre></td></tr></table></figure>






<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.render()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/10/pyecharts%E9%A5%BC%E5%9B%BE%20%E7%8E%AB%E7%91%B0%E5%9B%BE/%E7%8E%AB%E7%91%B0%E5%9B%BE.png" alt="图像"></p>
<h2 id="三、南丁格尔玫瑰图"><a href="#三、南丁格尔玫瑰图" class="headerlink" title="三、南丁格尔玫瑰图"></a>三、南丁格尔玫瑰图</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">provinces = [<span class="string">&#x27;北京&#x27;</span>,<span class="string">&#x27;上海&#x27;</span>,<span class="string">&#x27;黑龙江&#x27;</span>,<span class="string">&#x27;吉林&#x27;</span>,<span class="string">&#x27;辽宁&#x27;</span>,<span class="string">&#x27;内蒙古&#x27;</span>,<span class="string">&#x27;新疆&#x27;</span>,<span class="string">&#x27;西藏&#x27;</span>,<span class="string">&#x27;青海&#x27;</span>,<span class="string">&#x27;四川&#x27;</span>,<span class="string">&#x27;云南&#x27;</span>,<span class="string">&#x27;陕西&#x27;</span>,<span class="string">&#x27;重庆&#x27;</span>,</span><br><span class="line">             <span class="string">&#x27;贵州&#x27;</span>,<span class="string">&#x27;广西&#x27;</span>,<span class="string">&#x27;海南&#x27;</span>,<span class="string">&#x27;澳门&#x27;</span>,<span class="string">&#x27;湖南&#x27;</span>,<span class="string">&#x27;江西&#x27;</span>,<span class="string">&#x27;福建&#x27;</span>,<span class="string">&#x27;安徽&#x27;</span>,<span class="string">&#x27;浙江&#x27;</span>,<span class="string">&#x27;江苏&#x27;</span>,<span class="string">&#x27;宁夏&#x27;</span>,<span class="string">&#x27;山西&#x27;</span>,<span class="string">&#x27;河北&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>]</span><br><span class="line">num = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">42</span>,<span class="number">35</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">16</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">21</span>,<span class="number">37</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">22</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">13</span>,<span class="number">13</span>]</span><br><span class="line">color_series = [<span class="string">&#x27;#FAE927&#x27;</span>,<span class="string">&#x27;#E9E416&#x27;</span>,<span class="string">&#x27;#C9DA36&#x27;</span>,<span class="string">&#x27;#9ECB3C&#x27;</span>,<span class="string">&#x27;#6DBC49&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;#37B44E&#x27;</span>,<span class="string">&#x27;#3DBA78&#x27;</span>,<span class="string">&#x27;#14ADCF&#x27;</span>,<span class="string">&#x27;#209AC9&#x27;</span>,<span class="string">&#x27;#1E91CA&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;#2C6BA0&#x27;</span>,<span class="string">&#x27;#2B55A1&#x27;</span>,<span class="string">&#x27;#2D3D8E&#x27;</span>,<span class="string">&#x27;#44388E&#x27;</span>,<span class="string">&#x27;#6A368B&#x27;</span></span><br><span class="line">                <span class="string">&#x27;#7D3990&#x27;</span>,<span class="string">&#x27;#A63F98&#x27;</span>,<span class="string">&#x27;#C31C88&#x27;</span>,<span class="string">&#x27;#D52178&#x27;</span>,<span class="string">&#x27;#D5225B&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;#D02C2A&#x27;</span>,<span class="string">&#x27;#D44C2D&#x27;</span>,<span class="string">&#x27;#F57A34&#x27;</span>,<span class="string">&#x27;#FA8F2F&#x27;</span>,<span class="string">&#x27;#D99D21&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;#CF7B25&#x27;</span>,<span class="string">&#x27;#CF7B25&#x27;</span>,<span class="string">&#x27;#CF7B25&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建DataFrame</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;provinces&#x27;</span>: provinces, <span class="string">&#x27;num&#x27;</span>: num&#125;)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>provinces</th>
      <th>num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>北京</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>上海</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>黑龙江</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>吉林</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>辽宁</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.sort_values(by=<span class="string">&quot;num&quot;</span>,ascending=<span class="literal">True</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 提取数据</span></span><br><span class="line">v = df[<span class="string">&#x27;provinces&#x27;</span>].values.tolist()</span><br><span class="line">d = df[<span class="string">&#x27;num&#x27;</span>].values.tolist()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 绘制饼图</span></span><br><span class="line">pie1 = Pie(init_opts=opts.InitOpts(width=<span class="string">&#x27;1250px&#x27;</span>, height=<span class="string">&#x27;750px&#x27;</span>))</span><br><span class="line"><span class="comment"># 设置颜色</span></span><br><span class="line">pie1.set_colors(color_series)</span><br><span class="line"></span><br><span class="line">pie1.add(<span class="string">&quot;&quot;</span>, [<span class="built_in">list</span>(z) <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">zip</span>(v, d)],</span><br><span class="line">        radius=[<span class="string">&quot;30%&quot;</span>, <span class="string">&quot;100%&quot;</span>],</span><br><span class="line">        center=[<span class="string">&quot;50%&quot;</span>, <span class="string">&quot;50%&quot;</span>],</span><br><span class="line">        rosetype=<span class="string">&quot;area&quot;</span></span><br><span class="line">        )</span><br><span class="line"><span class="comment"># 设置全局配置项</span></span><br><span class="line">pie1.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;多省区市\n确诊病例连续多日&#x27;</span>,subtitle=<span class="string">&#x27;零新增&#x27;</span>,</span><br><span class="line">                                               title_textstyle_opts=opts.TextStyleOpts(font_size=<span class="number">25</span>,color= <span class="string">&#x27;#0085c3&#x27;</span>),</span><br><span class="line">                                               subtitle_textstyle_opts= opts.TextStyleOpts(font_size=<span class="number">50</span>,color= <span class="string">&#x27;#003399&#x27;</span>),</span><br><span class="line">                                               pos_right= <span class="string">&#x27;center&#x27;</span>,pos_left= <span class="string">&#x27;center&#x27;</span>,pos_top=<span class="string">&#x27;42%&#x27;</span>,pos_bottom=<span class="string">&#x27;center&#x27;</span></span><br><span class="line">                                              ),</span><br><span class="line">                     legend_opts=opts.LegendOpts(is_show=<span class="literal">False</span>),</span><br><span class="line">                     toolbox_opts=opts.ToolboxOpts())</span><br><span class="line"><span class="comment"># 设置系列配置项</span></span><br><span class="line">pie1.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">True</span>, position=<span class="string">&quot;inside&quot;</span>, font_size=<span class="number">12</span>,</span><br><span class="line">                                               formatter=<span class="string">&quot;&#123;b&#125;:&#123;c&#125;天&quot;</span>, font_style=<span class="string">&quot;italic&quot;</span>,</span><br><span class="line">                                               font_weight=<span class="string">&quot;bold&quot;</span>, font_family=<span class="string">&quot;SimHei&quot;</span></span><br><span class="line">                                               ),</span><br><span class="line">                     )</span><br><span class="line">pie1.load_javascript()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pie1.render_notebook()</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/10/pyecharts%E9%A5%BC%E5%9B%BE%20%E7%8E%AB%E7%91%B0%E5%9B%BE/%E5%8D%97%E4%B8%81%E6%A0%BC%E5%B0%94%E7%8E%AB%E7%91%B0%E5%9B%BE.png" alt="图像"></p>
]]></content>
      <categories>
        <category>数据可视化</category>
      </categories>
  </entry>
  <entry>
    <title>python爬取瓜子二手车</title>
    <url>/2021/03/10/python%E7%88%AC%E5%8F%96%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6/</url>
    <content><![CDATA[<p>自己平时比较喜欢车，但是又没钱，于是萌生了一个购买二手车的想法，最近二手车的市场行情是怎样的呢，这次爬取了二手车交易网站，了解一下交易的行情。</p>
<p>于是，本人便兴高采烈地打开了网站，还是根据爬虫的基本流程，首先对网页结构进行分析，发现二手车网站只显示50个页面的二手车信息。<br>按下F12,清除cookie,清除浏览器缓存，刷新页面，得到了下面这个页面。</p>
<span id="more"></span>
<p><img src="/2021/03/10/python%E7%88%AC%E5%8F%96%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6/1.png" alt="image.png"></p>
<p>首先。我看到了这两个buy文件，响应码分别是203和200，这是如果常玩爬虫的人，<br>便会想到这里边一定有猫腻，于是我打开了第一个buy页面，果然response的响应页面是看不到详细信息的，<br>既然如此，我们便打开第二个页面看一下，发现了我们想要的内容，如下：</p>
<p><img src="/2021/03/10/python%E7%88%AC%E5%8F%96%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6/2.png" alt="image.png"></p>
<p>这时，便可以写代码了，进行提取了，但是当我在进行请求时，却得不到想要的信息，这时我想可能是请求头的cookie出了问题，很有可能这里的cookie是根据上面的页面，动态生成的。</p>
<p>这就和前一个Buy脱不了干系，于是我用爬虫对第一个文件进了请求，想看一下里边到底有什么内容，<br>经过请求发现响应内容是乱码的js,如图所示：</p>
<p><img src="/2021/03/10/python%E7%88%AC%E5%8F%96%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6/3.png" alt="image.png"></p>
<p>仔细观察可发现，这里边是由一个eval()函数包着的，搜索antipas参数果然在这个响应文件中，那么就需要对该该js进行解码，<br>这是我只需要cosole.log()这个函数就可以了，得到解码后的js,如下图所示：</p>
<p><img src="/2021/03/10/python%E7%88%AC%E5%8F%96%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6/4.png" alt="image.png"></p>
<p>这里，只是稍微讲一下，那么接下来，就是写代码了，代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">headers=&#123;</span><br><span class="line"><span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;www.guazi.com&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://www.guazi.com/www/buy/o50c-1/&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;document&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;navigate&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="string">&#x27;?1&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line">city = <span class="built_in">input</span>(<span class="string">&quot;请输入要查询的地点缩写：&quot;</span>)</span><br><span class="line">url=<span class="string">&quot;https://www.guazi.com/%s/buy&quot;</span> % city</span><br><span class="line">response = requests.get(url,headers=headers)</span><br><span class="line">pattern = <span class="string">r&quot;value=anti\(&#x27;zoQ5hc4WI7OKZKzz0yvwhTimCXIlNazFSgv7ysBQVIE=&#x27;,&#x27;(\d+?)&#x27;\)&quot;</span></span><br><span class="line">ptt = re.<span class="built_in">compile</span>(pattern)</span><br><span class="line">key = re.findall(ptt,response.text)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">print(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;EXECJS_RUNTIME&quot;</span>] = <span class="string">&quot;PhantomJS&quot;</span></span><br><span class="line">node = execjs.get()</span><br><span class="line">file = <span class="string">&#x27;guaizi_1.js&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    js_data = f.read()</span><br><span class="line"></span><br><span class="line">result = execjs.<span class="built_in">compile</span>(js_data).call(<span class="string">&#x27;anti&#x27;</span>,<span class="string">&#x27;zoQ5hc4WI7OKZKzz0yvwhTimCXIlNazFSgv7ysBQVIE=&#x27;</span>,key)</span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate, br&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;rfnl=https://www.guazi.com/%s/buy; antipas=%s&#x27;</span> % (city,result),</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;www.guazi.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://www.guazi.com/%s/buy&#x27;</span> % city,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;document&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;navigate&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">car_list=[]</span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">51</span>):</span><br><span class="line">    print(page)</span><br><span class="line">    url = <span class="string">&quot;https://www.guazi.com/%s/buy/o%s&quot;</span> % (city,page)</span><br><span class="line">    req = requests.get(url,headers=headers)</span><br><span class="line">    html = etree.HTML(req.text)</span><br><span class="line">    li_bq_list = html.xpath(<span class="string">&#x27;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> li_bq <span class="keyword">in</span> li_bq_list:</span><br><span class="line">        car_dict = &#123;&#125;</span><br><span class="line">        desc_car = li_bq.xpath(<span class="string">&#x27;./a/h2/text()&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        sevice_list = li_bq.xpath(<span class="string">&#x27;./a/div[@class=&quot;t-i&quot;]/text()&#x27;</span>)</span><br><span class="line">        xianjia_list = li_bq.xpath(<span class="string">&#x27;./a/div[@class=&quot;t-price&quot;]/p//text()&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            yuanjia = li_bq.xpath(<span class="string">&#x27;./a/div[@class=&quot;t-price&quot;]/em/text()&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            yuanjia=<span class="string">&quot;&quot;</span></span><br><span class="line">        xianjia = <span class="string">&#x27;&#x27;</span>.join(xianjia_list).strip()</span><br><span class="line">        car_dict[<span class="string">&#x27;基本描述&#x27;</span>] = desc_car</span><br><span class="line">        car_dict[<span class="string">&#x27;服务&#x27;</span>] = sevice_list</span><br><span class="line">        car_dict[<span class="string">&#x27;原价&#x27;</span>] = yuanjia</span><br><span class="line">        car_dict[<span class="string">&#x27;现价&#x27;</span>] = xianjia</span><br><span class="line">        print(car_dict)</span><br><span class="line">        car_list.append(car_dict)</span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">df_car = pd.DataFrame(car_list)</span><br><span class="line">print(df_car)</span><br><span class="line">df_car.to_excel(<span class="string">&#x27;bj_car.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>最终，将其放在excel中，结果如图所示：</p>
<p><img src="/2021/03/10/python%E7%88%AC%E5%8F%96%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6/5.png" alt="image.png"></p>
<p>想要源码的可以评论区，留邮箱。</p>
]]></content>
      <categories>
        <category>python爬虫</category>
      </categories>
      <tags>
        <tag>爬虫</tag>
      </tags>
  </entry>
  <entry>
    <title>seaborn的基本使用</title>
    <url>/2021/03/09/seaborn%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<p>介绍python一种常用的的绘图库，他是对matplotlib的基本封装，并进行了美化，由于其调用起来<br>比较方便，所以还是有必要学习一下的。</p>
<span id="more"></span>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br></pre></td></tr></table></figure>


<figure class="highlight"><table><tr><td class="code"><pre><span class="line">?sns.set_style</span><br></pre></td></tr></table></figure>



<pre><code>Set the aesthetic style of the plots.

This affects things like the color of the axes, whether a grid is
enabled by default, and other aesthetic elements.

Parameters
----------
style : dict, None, or one of &#123;darkgrid, whitegrid, dark, white, ticks&#125;
    A dictionary of parameters or the name of a preconfigured set.
rc : dict, optional
    Parameter mappings to override the values in the preset seaborn
    style dictionaries. This only updates parameters that are
    considered part of the style definition.

Examples
--------
&gt;&gt;&gt; set_style(&quot;whitegrid&quot;)

&gt;&gt;&gt; set_style(&quot;ticks&quot;, &#123;&quot;xtick.major.size&quot;: 8, &quot;ytick.major.size&quot;: 8&#125;)

See Also
--------
axes_style : return a dict of parameters or use in a ``with`` statement
             to temporarily set the style.
set_context : set parameters to scale plot elements
set_palette : set the default color palette for figures
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sns.set_style(<span class="string">&#x27;whitegrid&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="1-数值型变量"><a href="#1-数值型变量" class="headerlink" title="1. 数值型变量"></a>1. 数值型变量</h2><h3 id="1-1-单变量分布和多变量分布"><a href="#1-1-单变量分布和多变量分布" class="headerlink" title="1.1 单变量分布和多变量分布"></a>1.1 单变量分布和多变量分布</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 这里采用seaborn自带的数据集，鸢尾花数据集</span></span><br><span class="line">iris = sns.load_dataset(<span class="string">&#x27;iris&#x27;</span>)</span><br><span class="line">iris.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>



<ul>
<li>jointplot</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sns.jointplot(x=<span class="string">&quot;sepal_length&quot;</span>,y=<span class="string">&quot;sepal_width&quot;</span>,data=iris)</span><br></pre></td></tr></table></figure>








<p><img src="/images/output_8_1.png" alt="png"></p>
<ul>
<li>pairplot</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sns.pairplot(data=iris)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_10_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># distplot(直方图)</span></span><br><span class="line">sns.distplot(iris[<span class="string">&#x27;sepal_length&#x27;</span>],rug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_11_1.png" alt="png"></p>
<h3 id="1-2-关系型图表"><a href="#1-2-关系型图表" class="headerlink" title="1.2 关系型图表"></a>1.2 关系型图表</h3><p>不同种类花的两变量散点图</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sns.scatterplot(x=<span class="string">&quot;sepal_width&quot;</span>,y=<span class="string">&quot;sepal_length&quot;</span>,hue=<span class="string">&quot;species&quot;</span>,data=iris)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_14_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 折线图</span></span><br><span class="line">sns.lineplot(x=<span class="string">&quot;sepal_width&quot;</span>,y=<span class="string">&quot;sepal_length&quot;</span>,hue=<span class="string">&quot;species&quot;</span>,data=iris)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_15_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sns.regplot(x=<span class="string">&quot;sepal_width&quot;</span>,y=<span class="string">&quot;sepal_length&quot;</span>,data=iris)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_16_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 残差分布图</span></span><br><span class="line">sns.residplot(x=<span class="string">&quot;sepal_width&quot;</span>,y=<span class="string">&quot;sepal_length&quot;</span>,data=iris)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_17_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tips= sns.load_dataset(<span class="string">&#x27;tips&#x27;</span>)</span><br><span class="line">tips.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 根据性别及是否抽烟，以及时间段，来看小费总额与小费的关系</span></span><br><span class="line">sns.lmplot(x=<span class="string">&quot;total_bill&quot;</span>,y=<span class="string">&quot;tip&quot;</span>,row=<span class="string">&#x27;sex&#x27;</span>,col=<span class="string">&quot;smoker&quot;</span>,hue=<span class="string">&quot;time&quot;</span>,data=tips)</span><br></pre></td></tr></table></figure>




<p><img src="/images/output_19_1.png" alt="png"></p>
<h3 id="1-3-矩阵图"><a href="#1-3-矩阵图" class="headerlink" title="1.3 矩阵图"></a>1.3 矩阵图</h3><p><strong>主要用于相关性分析</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sns.heatmap(iris.corr(),annot=<span class="literal">True</span>,fmt=<span class="string">&quot;.2f&quot;</span>,cmap=<span class="string">&quot;Blues&quot;</span>)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_22_1.png" alt="png"></p>
<h2 id="2-分类数据"><a href="#2-分类数据" class="headerlink" title="2. 分类数据"></a>2. 分类数据</h2><h3 id="2-1-散点图"><a href="#2-1-散点图" class="headerlink" title="2.1 散点图"></a>2.1 散点图</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># swarmplot</span></span><br><span class="line"><span class="comment"># 每一天根据男女不同的小费分布</span></span><br><span class="line">sns.swarmplot(x=<span class="string">&quot;day&quot;</span>,y=<span class="string">&quot;tip&quot;</span>,hue=<span class="string">&quot;sex&quot;</span>,data=tips)</span><br></pre></td></tr></table></figure>








<p><img src="/images/output_25_1.png" alt="png"></p>
<h3 id="2-2-分布图"><a href="#2-2-分布图" class="headerlink" title="2.2 分布图"></a>2.2 分布图</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 箱线图，表达了给分类数据下4分位数与离群点信息</span></span><br><span class="line">sns.boxplot(x=<span class="string">&quot;day&quot;</span>,y=<span class="string">&quot;tip&quot;</span>,hue=<span class="string">&quot;sex&quot;</span>,data=tips)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x21734900370&gt;
</code></pre>
<p><img src="/images/output_27_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 小提琴图</span></span><br><span class="line">sns.violinplot(x=<span class="string">&quot;day&quot;</span>,y=<span class="string">&quot;tip&quot;</span>,hue=<span class="string">&quot;sex&quot;</span>,data=tips,split=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_28_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 条形图</span></span><br><span class="line">sns.barplot(x=<span class="string">&#x27;day&#x27;</span>,y=<span class="string">&#x27;tip&#x27;</span>,hue=<span class="string">&#x27;sex&#x27;</span>,data=tips)</span><br></pre></td></tr></table></figure>









<p><img src="/images/output_29_1.png" alt="png"></p>
<p>这里只介绍几种个人常用的API，若想详细了解，请<a href="http://seaborn.pydata.org/api.html">参考</a></p>
]]></content>
      <categories>
        <category>数据可视化</category>
      </categories>
      <tags>
        <tag>seaborn</tag>
      </tags>
  </entry>
  <entry>
    <title>淘宝用户行为分析</title>
    <url>/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h1 id="一、项目背景"><a href="#一、项目背景" class="headerlink" title="一、项目背景"></a>一、项目背景</h1><p>以淘宝APP平台为数据集，通过行业的指标对淘宝用户行为进行分析，从而探索淘宝用户的行为模式，具体指标包括：日PV和日uv分析，付费率分析，复购行为分析，漏斗流失分析</p>
<span id="more"></span>
<h1 id="二、数据的读取"><a href="#二、数据的读取" class="headerlink" title="二、数据的读取"></a>二、数据的读取</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mpl.rcParams[<span class="string">&#x27;font.family&#x27;</span>]=<span class="string">&#x27;SimHei&#x27;</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.style&#x27;</span>] = <span class="string">&#x27;italic&#x27;</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.size&#x27;</span>] = <span class="number">16</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] =<span class="literal">False</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;tianchi_mobile_recommend_train_user.csv&#x27;</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>behavior_type</th>
      <th>user_geohash</th>
      <th>item_category</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98047837</td>
      <td>232431562</td>
      <td>1</td>
      <td>NaN</td>
      <td>4245</td>
      <td>2014-12-06 02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97726136</td>
      <td>383583590</td>
      <td>1</td>
      <td>NaN</td>
      <td>5894</td>
      <td>2014-12-09 20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98607707</td>
      <td>64749712</td>
      <td>1</td>
      <td>NaN</td>
      <td>2883</td>
      <td>2014-12-18 11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98662432</td>
      <td>320593836</td>
      <td>1</td>
      <td>96nn52n</td>
      <td>6562</td>
      <td>2014-12-06 10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98145908</td>
      <td>290208520</td>
      <td>1</td>
      <td>NaN</td>
      <td>13926</td>
      <td>2014-12-16 21</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>

<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 12256906 entries, 0 to 12256905
Data columns (total 6 columns):
 #   Column         Dtype 
---  ------         ----- 
 0   user_id        int64 
 1   item_id        int64 
 2   behavior_type  int64 
 3   user_geohash   object
 4   item_category  int64 
 5   time           object
dtypes: int64(4), object(2)
memory usage: 561.1+ MB
</code></pre>
<h1 id="二、数据的清洗与处理"><a href="#二、数据的清洗与处理" class="headerlink" title="二、数据的清洗与处理"></a>二、数据的清洗与处理</h1><p>user_geohash列有空值，看一下空值的比例</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df[<span class="string">&#x27;user_geohash&#x27;</span>].isnull().<span class="built_in">sum</span>()/df[<span class="string">&#x27;user_geohash&#x27;</span>].isnull().count()</span><br></pre></td></tr></table></figure>




<pre><code>0.6800104365653127
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df[<span class="string">&#x27;天&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>,expand=<span class="literal">True</span>)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df[<span class="string">&#x27;小时&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>,expand=<span class="literal">True</span>)[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>behavior_type</th>
      <th>user_geohash</th>
      <th>item_category</th>
      <th>time</th>
      <th>天</th>
      <th>小时</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98047837</td>
      <td>232431562</td>
      <td>1</td>
      <td>NaN</td>
      <td>4245</td>
      <td>2014-12-06 02</td>
      <td>2014-12-06</td>
      <td>02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97726136</td>
      <td>383583590</td>
      <td>1</td>
      <td>NaN</td>
      <td>5894</td>
      <td>2014-12-09 20</td>
      <td>2014-12-09</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98607707</td>
      <td>64749712</td>
      <td>1</td>
      <td>NaN</td>
      <td>2883</td>
      <td>2014-12-18 11</td>
      <td>2014-12-18</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98662432</td>
      <td>320593836</td>
      <td>1</td>
      <td>96nn52n</td>
      <td>6562</td>
      <td>2014-12-06 10</td>
      <td>2014-12-06</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98145908</td>
      <td>290208520</td>
      <td>1</td>
      <td>NaN</td>
      <td>13926</td>
      <td>2014-12-16 21</td>
      <td>2014-12-16</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.columns =[<span class="string">&quot;用户ID&quot;</span>,<span class="string">&quot;商品ID&quot;</span>,<span class="string">&quot;用户行为&quot;</span>,<span class="string">&quot;地理位置&quot;</span>,<span class="string">&quot;品类ID&quot;</span>,<span class="string">&quot;日期&quot;</span>,<span class="string">&quot;天&quot;</span>,<span class="string">&quot;小时&quot;</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>商品ID</th>
      <th>用户行为</th>
      <th>地理位置</th>
      <th>品类ID</th>
      <th>日期</th>
      <th>天</th>
      <th>小时</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98047837</td>
      <td>232431562</td>
      <td>1</td>
      <td>NaN</td>
      <td>4245</td>
      <td>2014-12-06 02</td>
      <td>2014-12-06</td>
      <td>02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97726136</td>
      <td>383583590</td>
      <td>1</td>
      <td>NaN</td>
      <td>5894</td>
      <td>2014-12-09 20</td>
      <td>2014-12-09</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98607707</td>
      <td>64749712</td>
      <td>1</td>
      <td>NaN</td>
      <td>2883</td>
      <td>2014-12-18 11</td>
      <td>2014-12-18</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98662432</td>
      <td>320593836</td>
      <td>1</td>
      <td>96nn52n</td>
      <td>6562</td>
      <td>2014-12-06 10</td>
      <td>2014-12-06</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98145908</td>
      <td>290208520</td>
      <td>1</td>
      <td>NaN</td>
      <td>13926</td>
      <td>2014-12-16 21</td>
      <td>2014-12-16</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>

<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 12256906 entries, 0 to 12256905
Data columns (total 8 columns):
 #   Column  Dtype 
---  ------  ----- 
 0   用户ID    int64 
 1   商品ID    int64 
 2   用户行为    int64 
 3   地理位置    object
 4   品类ID    int64 
 5   日期      object
 6   天       object
 7   小时      object
dtypes: int64(4), object(4)
memory usage: 748.1+ MB
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df[<span class="string">&quot;日期&quot;</span>] =pd.to_datetime(df[<span class="string">&#x27;日期&#x27;</span>])</span><br><span class="line">df[<span class="string">&#x27;天&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;天&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>商品ID</th>
      <th>用户行为</th>
      <th>地理位置</th>
      <th>品类ID</th>
      <th>日期</th>
      <th>天</th>
      <th>小时</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98047837</td>
      <td>232431562</td>
      <td>1</td>
      <td>NaN</td>
      <td>4245</td>
      <td>2014-12-06 02:00:00</td>
      <td>2014-12-06</td>
      <td>02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97726136</td>
      <td>383583590</td>
      <td>1</td>
      <td>NaN</td>
      <td>5894</td>
      <td>2014-12-09 20:00:00</td>
      <td>2014-12-09</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98607707</td>
      <td>64749712</td>
      <td>1</td>
      <td>NaN</td>
      <td>2883</td>
      <td>2014-12-18 11:00:00</td>
      <td>2014-12-18</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98662432</td>
      <td>320593836</td>
      <td>1</td>
      <td>96nn52n</td>
      <td>6562</td>
      <td>2014-12-06 10:00:00</td>
      <td>2014-12-06</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98145908</td>
      <td>290208520</td>
      <td>1</td>
      <td>NaN</td>
      <td>13926</td>
      <td>2014-12-16 21:00:00</td>
      <td>2014-12-16</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 取消pandas科学技术法</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.float_format&#x27;</span>, <span class="keyword">lambda</span> x: <span class="string">&#x27;%.3f&#x27;</span> % x)</span><br><span class="line">df.describe()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>商品ID</th>
      <th>用户行为</th>
      <th>品类ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12256906.000</td>
      <td>12256906.000</td>
      <td>12256906.000</td>
      <td>12256906.000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>71707324.052</td>
      <td>202308365.377</td>
      <td>1.105</td>
      <td>6846.162</td>
    </tr>
    <tr>
      <th>std</th>
      <td>41229195.091</td>
      <td>116739662.863</td>
      <td>0.457</td>
      <td>3809.922</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4913.000</td>
      <td>64.000</td>
      <td>1.000</td>
      <td>2.000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>35849648.000</td>
      <td>101413047.000</td>
      <td>1.000</td>
      <td>3721.000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>72928045.000</td>
      <td>202135938.000</td>
      <td>1.000</td>
      <td>6209.000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>107377446.000</td>
      <td>303540514.000</td>
      <td>1.000</td>
      <td>10290.000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>142455899.000</td>
      <td>404562461.000</td>
      <td>4.000</td>
      <td>14080.000</td>
    </tr>
  </tbody>
</table>
</div>



<h1 id="三、总体用户行为分析"><a href="#三、总体用户行为分析" class="headerlink" title="三、总体用户行为分析"></a>三、总体用户行为分析</h1><h2 id="1-PV和UV分析"><a href="#1-PV和UV分析" class="headerlink" title="(1) PV和UV分析"></a>(1) PV和UV分析</h2><p>PV(页面浏览量):即Page View,它是指页面浏览量或点击量，页面被刷新一次计一次。<br>UV(独立访客量): 即Unique Visitor,访问网站的用户ID计一次。</p>
<h3 id="1-日访问量"><a href="#1-日访问量" class="headerlink" title="1. 日访问量"></a>1. 日访问量</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df_daily_pv = df.groupby(<span class="string">&#x27;天&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count()</span><br><span class="line">df_daily_uv = df.groupby(<span class="string">&#x27;天&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(df_daily_pv)</span><br><span class="line">plt.title(<span class="string">u&#x27;日访问量&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">60</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_24_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(df_daily_uv)</span><br><span class="line">plt.title(<span class="string">u&#x27;独立访客量&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">60</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_25_0.png" alt="png"></p>
<p>结果显示：在双十二期间，pv和uv访问量均达到峰值，且pv和uv两个访问量数值差距较大</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 日活跃度</span></span><br><span class="line"></span><br><span class="line">user_id_num = df[<span class="string">&#x27;用户ID&#x27;</span>].nunique()</span><br><span class="line">daily_user = df_daily_uv/user_id_num</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(daily_user)</span><br><span class="line">plt.title(<span class="string">u&#x27;注册用户日活跃率&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">60</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_27_0.png" alt="png"></p>
<p>可以看出：淘宝用户在双十二期间日活跃度为60%-66%，在双十二当天，达到峰值77%左右。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pv_hour记录用户每小时操作数量</span></span><br><span class="line">pv_hour = df.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count()</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(pv_hour)</span><br><span class="line">plt.title(<span class="string">u&#x27;小时访问量&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_29_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">uv_hour = df.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique()</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(uv_hour)</span><br><span class="line">plt.title(<span class="string">u&#x27;小时在线人数&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_30_0.png" alt="png"></p>
<p>可以看出:pv和uv在凌晨0-5点期间波动情况相同，都呈下降趋势，凌晨5点之后，都呈上升趋势，10点之后保持平稳状态。其中，在在晚上18：00左右，pv大幅度上升，21点左右达到顶峰，相比来看uv波动不太明显，可见晚上18：00以后是淘宝用户访问app的活跃时间段。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 不同行为用户pv分析</span></span><br><span class="line">df_01 =df.query(<span class="string">&#x27;用户行为==1&#x27;</span>)</span><br><span class="line">df_02 = df.query(<span class="string">&#x27;用户行为==2&#x27;</span>)</span><br><span class="line">df_03 = df.query(<span class="string">&quot;用户行为==3&quot;</span>)</span><br><span class="line">df_04 = df.query(<span class="string">&quot;用户行为==4&quot;</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">sns.lineplot(data=df_01.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count(),label=<span class="string">&quot;点击&quot;</span>)</span><br><span class="line">sns.lineplot(data=df_02.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count(),label=<span class="string">&quot;收藏&quot;</span>)</span><br><span class="line">sns.lineplot(data=df_03.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count(),label=<span class="string">&quot;加入购物车&quot;</span>)</span><br><span class="line">sns.lineplot(data = df_04.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count(),label=<span class="string">&quot;下单&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_32_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 不同行为用户uv分析</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">sns.lineplot(data=df_01.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique(),label=<span class="string">&quot;点击&quot;</span>)</span><br><span class="line">sns.lineplot(data=df_02.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique(),label=<span class="string">&quot;收藏&quot;</span>)</span><br><span class="line">sns.lineplot(data=df_03.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique(),label=<span class="string">&quot;加入购物车&quot;</span>)</span><br><span class="line">sns.lineplot(data = df_04.groupby(<span class="string">&#x27;小时&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique(),label=<span class="string">&quot;下单&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_33_0.png" alt="png"></p>
<p>总体的操作量波动，与各行为操作量的波动是一致的，且各操作量排序为点击，加入购物车，收藏，购买，且晚上用户操作最为频繁</p>
<h1 id="四、用户消费行为分析"><a href="#四、用户消费行为分析" class="headerlink" title="四、用户消费行为分析"></a>四、用户消费行为分析</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 用户购买次数分析</span></span><br><span class="line">df_buy = df_04.groupby([<span class="string">&#x27;用户ID&#x27;</span>])[<span class="string">&#x27;用户行为&#x27;</span>].count()</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>))</span><br><span class="line">sns.distplot(df_buy)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;用户购买次数&#x27;</span>)</span><br><span class="line">plt.xlim([<span class="number">0</span>,<span class="number">100</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_36_0.png" alt="png"></p>
<p>随着购买次数的增加，购买人数在不断下降，需要重点关注十次以上的客户。</p>
<p>(1) ARPPU(Average Renvenu per pay user) 它是指每位付费用户的平均付费额度。  </p>
<ul>
<li>ARPPU = 总付费额度/付费总人数</li>
<li>由于这里没付费金额，这里用付费次数代替</li>
<li>总付费次数/用户数</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">daily_user_buy = df_04.groupby(<span class="string">&#x27;天&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique()</span><br><span class="line">daily_user_buy_pinci = df_04.groupby(<span class="string">&#x27;天&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count()</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(daily_user_buy_pinci/daily_user_buy)</span><br><span class="line">plt.title(<span class="string">&#x27;ARPPU&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">60</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_39_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">(daily_user_buy_pinci/daily_user_buy).mean()</span><br></pre></td></tr></table></figure>




<pre><code>2.36844627368819
</code></pre>
<p>每日付费次数在2次左右，双十二当天人均付费次数达到将近四次</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data1=df[df[<span class="string">&#x27;用户行为&#x27;</span>]==<span class="number">4</span>].groupby([<span class="string">&#x27;日期&#x27;</span>])[<span class="string">&#x27;用户行为&#x27;</span>].count()  <span class="comment">#每天用户消费总次数</span></span><br><span class="line">data2=df.groupby([<span class="string">&#x27;日期&#x27;</span>])[<span class="string">&#x27;用户ID&#x27;</span>].nunique()<span class="comment">#每天活跃人数</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(data1/data2)</span><br><span class="line">plt.title(<span class="string">&#x27;活跃用户数日平均消费次数&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_42_0.png" alt="png"></p>
<p>图表显示，淘宝活跃用户（有过操作行为的用户）平均每天消费次数比较低，在0.6次左右，双十二期间达到最高值，有2左右。</p>
<p><strong>付费率 = 付费人数/活跃人数</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">daily_pay_lv = daily_user_buy/df.groupby(<span class="string">&#x27;天&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].nunique()</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(daily_pay_lv)</span><br><span class="line">plt.title(<span class="string">&#x27;日付费率&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_45_0.png" alt="png"></p>
<p>图表显示：每天活跃用户人群中，大概25%的用户具有消费行为，在双十二期间消费用户人数最多。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#每个时间段用户消费次数分布</span></span><br><span class="line">data1=df[df[<span class="string">&#x27;用户行为&#x27;</span>]==<span class="number">4</span>].groupby([<span class="string">&#x27;小时&#x27;</span>])[<span class="string">&#x27;用户行为&#x27;</span>].count()<span class="comment">#每个时间段的消费总次数</span></span><br><span class="line">data2=df[df[<span class="string">&#x27;用户行为&#x27;</span>]==<span class="number">4</span>].groupby([<span class="string">&#x27;小时&#x27;</span>])[<span class="string">&#x27;用户ID&#x27;</span>].nunique()<span class="comment">#每个时间段的消费人数</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">plt.plot(data1/data2)</span><br><span class="line">plt.title(<span class="string">&#x27;每个时间段用户消费次数&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_47_0.png" alt="png"></p>
<p>可以看出：每天凌晨过后，消费次数开始下降，早上7点左右，消费次数开始上升，10点左右开始稳定在2.6次左右，到晚上22点左右是消费高峰期。</p>
<h1 id="五、复购行为分析"><a href="#五、复购行为分析" class="headerlink" title="五、复购行为分析"></a>五、复购行为分析</h1><p>复购：一段时间内消费两次及以上的用户数<br>复购率：一段时间内消费两次及以上的用户数/消费总人数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">user_buy_lv = df_04.groupby(<span class="string">&#x27;用户ID&#x27;</span>)[<span class="string">&#x27;天&#x27;</span>].nunique()</span><br><span class="line">user_buy_lv</span><br></pre></td></tr></table></figure>




<pre><code>用户ID
4913         5
6118         1
7528         6
7591         9
12645        4
            ..
142376113    1
142412247    7
142430177    5
142450275    8
142455899    7
Name: 天, Length: 8886, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">len</span>(user_buy_lv[user_buy_lv&gt;<span class="number">2</span>])/<span class="built_in">len</span>(user_buy_lv)</span><br></pre></td></tr></table></figure>




<pre><code>0.7451046590141797
</code></pre>
<p>可以看出，用户三十天复购率在74%以上，产品还是非常健康的</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data =df_04.groupby([<span class="string">&#x27;用户ID&#x27;</span>,<span class="string">&quot;天&quot;</span>]).count().reset_index()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data =data.groupby(<span class="string">&#x27;用户ID&#x27;</span>)[<span class="string">&#x27;天&#x27;</span>].diff(<span class="number">1</span>).dropna()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = data.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x.days)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data</span><br></pre></td></tr></table></figure>




<pre><code>1        6
2        4
3        2
4        3
7        4
        ..
49196    2
49197    2
49198    4
49199    3
49200    1
Name: 天, Length: 40315, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">data.value_counts().plot.bar()</span><br><span class="line">plt.title(<span class="string">&#x27;复购时间间隔分布&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;复购时间间隔&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;购买人数&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_58_0.png" alt="png"></p>
<p>从图可以看出：消费次数随着消费时间间隔的增加而不断下降，在1-10天之内复购次数比较多，10天之后淘宝用户很少再进行复购，因此需要重视10天之内的淘宝用户复购行为，增加用户复购。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">sns.distplot(data)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_60_0.png" alt="png"></p>
<p>总体来看，呈现逐渐下降趋势。多数淘宝用户平均复购时间集中在1-10天时间间隔内</p>
<h1 id="六、漏斗流失分析"><a href="#六、漏斗流失分析" class="headerlink" title="六、漏斗流失分析"></a>六、漏斗流失分析</h1><p>漏斗分析是一套流程式数据分析，它能够科学反映用户行为状态以及从起点到终点各阶段用户转化率情况的重要分析模型</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> options <span class="keyword">as</span> opts</span><br><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> Funnel</span><br><span class="line"><span class="keyword">from</span> pyecharts.<span class="built_in">globals</span> <span class="keyword">import</span> CurrentConfig, NotebookType  </span><br><span class="line">CurrentConfig.NOTEBOOK_TYPE = NotebookType.JUPYTER_LAB</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = df.groupby(<span class="string">&#x27;用户行为&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].count().reset_index()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data[<span class="string">&#x27;行为&#x27;</span>]=data[<span class="string">&#x27;用户行为&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="number">1</span>:<span class="string">&quot;点击&quot;</span>,<span class="number">2</span>:<span class="string">&quot;收藏&quot;</span>,<span class="number">3</span>:<span class="string">&quot;加入购物车&quot;</span>,<span class="number">4</span>:<span class="string">&quot;下单&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.rename(columns=&#123;<span class="string">&#x27;用户ID&#x27;</span>:<span class="string">&quot;行为次数&quot;</span>&#125;,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data[<span class="string">&#x27;剩余客户&#x27;</span>]=data[<span class="string">&#x27;行为次数&#x27;</span>]/data[<span class="string">&#x27;行为次数&#x27;</span>].<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = (</span><br><span class="line">    Funnel()</span><br><span class="line">    .add(<span class="string">&quot;客户流失漏斗&quot;</span>, [<span class="built_in">list</span>(z) <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">zip</span>(data[<span class="string">&#x27;行为&#x27;</span>].tolist(), data[<span class="string">&#x27;剩余客户&#x27;</span>].tolist())])</span><br><span class="line">    .set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&quot;客户流失漏斗分析&quot;</span>))</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">c.load_javascript()</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/%E4%B8%8B%E8%BD%BD.png" alt="图像"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c.render()</span><br></pre></td></tr></table></figure>




<h1 id="七、用户行为与商品种类关系分析"><a href="#七、用户行为与商品种类关系分析" class="headerlink" title="七、用户行为与商品种类关系分析"></a>七、用户行为与商品种类关系分析</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data =pd.pivot_table(data=df,index=<span class="string">&#x27;品类ID&#x27;</span>,columns=<span class="string">&quot;用户行为&quot;</span>,values=<span class="string">&quot;商品ID&quot;</span>,aggfunc=<span class="string">&quot;count&quot;</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.columns=[<span class="string">&#x27;点击&#x27;</span>,<span class="string">&quot;收藏&quot;</span>,<span class="string">&quot;加入购物车&quot;</span>,<span class="string">&quot;下单&quot;</span>]</span><br><span class="line">data.fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>点击</th>
      <th>收藏</th>
      <th>加入购物车</th>
      <th>下单</th>
    </tr>
    <tr>
      <th>品类ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>976.000</td>
      <td>9.000</td>
      <td>4.000</td>
      <td>4.000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14075</th>
      <td>44.000</td>
      <td>0.000</td>
      <td>3.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>14076</th>
      <td>28.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>14078</th>
      <td>60.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>14079</th>
      <td>93007.000</td>
      <td>2189.000</td>
      <td>2515.000</td>
      <td>479.000</td>
    </tr>
    <tr>
      <th>14080</th>
      <td>86.000</td>
      <td>3.000</td>
      <td>1.000</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
<p>8916 rows × 4 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data[<span class="string">&#x27;点击_下单转化率&#x27;</span>] = data[<span class="string">&#x27;下单&#x27;</span>]/data[<span class="string">&#x27;点击&#x27;</span>]</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">(data[<span class="string">&#x27;点击_下单转化率&#x27;</span>]&gt;<span class="number">1</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>




<pre><code>0
</code></pre>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>点击</th>
      <th>收藏</th>
      <th>加入购物车</th>
      <th>下单</th>
      <th>点击_下单转化率</th>
    </tr>
    <tr>
      <th>品类ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>976.000</td>
      <td>9.000</td>
      <td>4.000</td>
      <td>4.000</td>
      <td>0.004</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.sort_values(by=<span class="string">&quot;点击_下单转化率&quot;</span>,ascending=<span class="literal">False</span>)[:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>点击</th>
      <th>收藏</th>
      <th>加入购物车</th>
      <th>下单</th>
      <th>点击_下单转化率</th>
    </tr>
    <tr>
      <th>品类ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4527</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>2.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>7628</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>12895</th>
      <td>2.000</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>2.000</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>8680</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>7912</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>5105</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>5069</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>13900</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>11336</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>129</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>0.500</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">sns.distplot(data[<span class="string">&#x27;点击_下单转化率&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;点击_下单转化率&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_79_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.query(<span class="string">&#x27;点击_下单转化率&gt;0&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>点击</th>
      <th>收藏</th>
      <th>加入购物车</th>
      <th>下单</th>
      <th>点击_下单转化率</th>
    </tr>
    <tr>
      <th>品类ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>976.000</td>
      <td>9.000</td>
      <td>4.000</td>
      <td>4.000</td>
      <td>0.004</td>
    </tr>
    <tr>
      <th>10</th>
      <td>212.000</td>
      <td>3.000</td>
      <td>9.000</td>
      <td>4.000</td>
      <td>0.019</td>
    </tr>
    <tr>
      <th>11</th>
      <td>8818.000</td>
      <td>94.000</td>
      <td>78.000</td>
      <td>5.000</td>
      <td>0.001</td>
    </tr>
    <tr>
      <th>12</th>
      <td>194.000</td>
      <td>8.000</td>
      <td>14.000</td>
      <td>5.000</td>
      <td>0.026</td>
    </tr>
    <tr>
      <th>13</th>
      <td>99.000</td>
      <td>6.000</td>
      <td>2.000</td>
      <td>6.000</td>
      <td>0.061</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14066</th>
      <td>184.000</td>
      <td>9.000</td>
      <td>7.000</td>
      <td>2.000</td>
      <td>0.011</td>
    </tr>
    <tr>
      <th>14068</th>
      <td>32.000</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>2.000</td>
      <td>0.062</td>
    </tr>
    <tr>
      <th>14073</th>
      <td>189.000</td>
      <td>1.000</td>
      <td>48.000</td>
      <td>17.000</td>
      <td>0.090</td>
    </tr>
    <tr>
      <th>14075</th>
      <td>44.000</td>
      <td>0.000</td>
      <td>3.000</td>
      <td>1.000</td>
      <td>0.023</td>
    </tr>
    <tr>
      <th>14079</th>
      <td>93007.000</td>
      <td>2189.000</td>
      <td>2515.000</td>
      <td>479.000</td>
      <td>0.005</td>
    </tr>
  </tbody>
</table>
<p>4662 rows × 5 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)</span><br><span class="line">sns.distplot(data.query(<span class="string">&#x27;点击_下单转化率&gt;0&#x27;</span>))</span><br><span class="line">plt.title(<span class="string">&#x27;点击_下单转化率&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/2021/03/16/%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/output_81_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#将点击-购买转化率分三类查看各类占比例</span></span><br><span class="line">data_rate=pd.cut(data[<span class="string">&#x27;点击_下单转化率&#x27;</span>],[<span class="number">0</span>,<span class="number">0.1</span>,<span class="number">0.4</span>,<span class="number">1</span>]).value_counts()</span><br><span class="line">data_rate/data_rate.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>




<pre><code>(0.0, 0.1]   0.961
(0.1, 0.4]   0.036
(0.4, 1.0]   0.003
Name: 点击_下单转化率, dtype: float64
</code></pre>
<p>转化率在0.1以下的商品占据了96%，在转化率在0.1-0.4的商品占据了3.6%。</p>
<h1 id="八、二八理论分析"><a href="#八、二八理论分析" class="headerlink" title="八、二八理论分析"></a>八、二八理论分析</h1><p>二八定理：市场上20%的商品占据了80%的销售额</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>点击</th>
      <th>收藏</th>
      <th>加入购物车</th>
      <th>下单</th>
      <th>点击_下单转化率</th>
    </tr>
    <tr>
      <th>品类ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>976.000</td>
      <td>9.000</td>
      <td>4.000</td>
      <td>4.000</td>
      <td>0.004</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">value_8 = data[<span class="string">&#x27;下单&#x27;</span>].<span class="built_in">sum</span>()*<span class="number">0.8</span></span><br><span class="line">data =data.sort_values(<span class="string">&#x27;下单&#x27;</span>,ascending=<span class="literal">False</span>)</span><br><span class="line">data[<span class="string">&#x27;累计下单量&#x27;</span>] = data[<span class="string">&#x27;下单&#x27;</span>].cumsum()</span><br><span class="line">data[<span class="string">&#x27;比列&#x27;</span>] = data[<span class="string">&#x27;累计下单量&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="string">&quot;后80%商品&quot;</span> <span class="keyword">if</span> x&gt;value_8 <span class="keyword">else</span> <span class="string">&quot;前20%的商品&quot;</span>)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>点击</th>
      <th>收藏</th>
      <th>加入购物车</th>
      <th>下单</th>
      <th>点击_下单转化率</th>
      <th>累计下单量</th>
      <th>比列</th>
    </tr>
    <tr>
      <th>品类ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6344</th>
      <td>85369.000</td>
      <td>1660.000</td>
      <td>3822.000</td>
      <td>2208.000</td>
      <td>0.026</td>
      <td>2208.000</td>
      <td>前20%的商品</td>
    </tr>
    <tr>
      <th>1863</th>
      <td>371738.000</td>
      <td>10200.000</td>
      <td>9309.000</td>
      <td>2000.000</td>
      <td>0.005</td>
      <td>4208.000</td>
      <td>前20%的商品</td>
    </tr>
    <tr>
      <th>5232</th>
      <td>135506.000</td>
      <td>2597.000</td>
      <td>4486.000</td>
      <td>1611.000</td>
      <td>0.012</td>
      <td>5819.000</td>
      <td>前20%的商品</td>
    </tr>
    <tr>
      <th>6977</th>
      <td>22806.000</td>
      <td>273.000</td>
      <td>2007.000</td>
      <td>1324.000</td>
      <td>0.058</td>
      <td>7143.000</td>
      <td>前20%的商品</td>
    </tr>
    <tr>
      <th>8877</th>
      <td>63396.000</td>
      <td>1247.000</td>
      <td>1974.000</td>
      <td>1072.000</td>
      <td>0.017</td>
      <td>8215.000</td>
      <td>前20%的商品</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6299</th>
      <td>25.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>120205.000</td>
      <td>后80%商品</td>
    </tr>
    <tr>
      <th>6297</th>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>120205.000</td>
      <td>后80%商品</td>
    </tr>
    <tr>
      <th>6291</th>
      <td>4.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>120205.000</td>
      <td>后80%商品</td>
    </tr>
    <tr>
      <th>6290</th>
      <td>2.000</td>
      <td>0.000</td>
      <td>2.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>120205.000</td>
      <td>后80%商品</td>
    </tr>
    <tr>
      <th>14080</th>
      <td>86.000</td>
      <td>3.000</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>120205.000</td>
      <td>后80%商品</td>
    </tr>
  </tbody>
</table>
<p>8916 rows × 7 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data[<span class="string">&#x27;比列&#x27;</span>].value_counts()/<span class="number">8916</span></span><br></pre></td></tr></table></figure>




<pre><code>后80%商品    0.919
前20%的商品   0.081
Name: 比列, dtype: float64
</code></pre>
<p>下单量的80%，由8.1%的商品种类承包，需要注意这些商品的库存及时补给</p>
]]></content>
      <categories>
        <category>数据分析实战</category>
      </categories>
  </entry>
</search>
